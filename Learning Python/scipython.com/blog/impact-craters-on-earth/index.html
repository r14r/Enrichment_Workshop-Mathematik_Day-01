<!doctype html>
<html lang="en">


<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="">
<meta name="description" content="The Earth Impact Database is a collection of images, publications and abstracts that provides information about confirmed impact structures for the scientific community. It is hosted at the Planetary and Space Science Centre (PASSC) of the University of New Brunswick.">
<title>Impact craters on Earth</title>
<link rel="shortcut icon" href="/static/img/favicon.ico">


<link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feeds/rss/">
<link rel="alternate" type="application/atom+xml" title="Atom" href="/blog/feeds/atom/">



<link rel="stylesheet" href="/static/css/bootstrap.css">
<link rel="stylesheet" href="/static/css/mezzanine.css">
<link rel="stylesheet" href="/static/css/codehilite.css">
<link rel="stylesheet" href="/static/css/custom.css">






<script src="/static/mezzanine/js/jquery-1.8.3.min.js"></script>
<script src="/static/js/bootstrap.js"></script>
<script src="/static/js/bootstrap-extras.js"></script>



<!--[if lt IE 9]>
<script src="/static/js/html5shiv.js"></script>
<script src="/static/js/respond.min.js"></script>
<![endif]-->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body id="body">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle Navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
    
    
</div>
<div class="navbar-collapse collapse">
    
<form action="/search/" class="navbar-form navbar-right" role="search">

<div class="form-group">
    <input class="form-control" placeholder="Search" type="text" name="q" value="">
</div>


    
    <div class="form-group">
    <select class="form-control" name="type">
        <option value="">Everything</option>
        
        <option value="blog.BlogPost"
            >
            Blog posts
        </option>
        
        <option value="pages.Page"
            >
            Pages
        </option>
        
    </select>
    </div>
    


<input type="submit" class="btn btn-default" value="Go">

</form>

    
<ul class="nav navbar-nav"><li id="dropdown-menu-home"><a href="/">Home</a></li><li class="dropdown
               "
        id="about"><a href="/about/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            About
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="about-the-author"><a href="/about/the-author/">The Author</a></li><li class="
               "
        id="about-the-book"><a href="/about/the-book/">The Book</a></li><li class="
               "
        id="about-this-website"><a href="/about/this-website/">This Website</a></li></ul></li><li class="dropdown
               "
        id="book"><a href="/book/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            Book
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-1-introduction"><a href="/book/chapter-1-introduction/">Chapter 1: Introduction</a></li><li class="dropdown-submenu
               "
        id="book-chapter-2-the-core-python-language-i"><a href="/book/chapter-2-the-core-python-language-i/">Chapter 2: The Core Python Language I</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-2-the-core-python-language-i-examples"><a href="/book/chapter-2-the-core-python-language-i/examples/">Examples</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions"><a href="/book/chapter-2-the-core-python-language-i/questions/">Questions</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions-problems"><a href="/book/chapter-2-the-core-python-language-i/questions/problems/">Problems</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-additional-problems"><a href="/book/chapter-2-the-core-python-language-i/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-3-simple-plotting-with-pylab"><a href="/book/chapter-3-simple-plotting-with-pylab/">Chapter 3: Simple Plotting with pylab</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-examples"><a href="/book/chapter-3-simple-plotting-with-pylab/examples/">Examples</a></li><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-problems"><a href="/book/chapter-3-simple-plotting-with-pylab/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-4-the-core-python-language-ii"><a href="/book/chapter-4-the-core-python-language-ii/">Chapter 4: The core Python language II</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-examples"><a href="/book/chapter-4-the-core-python-language-ii/examples/">Examples</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-questions"><a href="/book/chapter-4-the-core-python-language-ii/questions/">Questions</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-problems"><a href="/book/chapter-4-the-core-python-language-ii/problems/">Problems</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-additional-problems"><a href="/book/chapter-4-the-core-python-language-ii/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-5-ipython-and-ipython-notebook"><a href="/book/chapter-5-ipython-and-ipython-notebook/">Chapter 5: IPython and IPython Notebook</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-5-ipython-and-ipython-notebook-examples"><a href="/book/chapter-5-ipython-and-ipython-notebook/examples/">Examples</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-6-numpy"><a href="/book/chapter-6-numpy/">Chapter 6: NumPy</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-6-numpy-examples"><a href="/book/chapter-6-numpy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-questions"><a href="/book/chapter-6-numpy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-6-numpy-problems"><a href="/book/chapter-6-numpy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-examples"><a href="/book/chapter-6-numpy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-problems"><a href="/book/chapter-6-numpy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-7-matplotlib"><a href="/book/chapter-7-matplotlib/">Chapter 7: Matplotlib</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-7-matplotlib-examples"><a href="/book/chapter-7-matplotlib/examples/">Examples</a></li><li class="
               "
        id="book-chapter-7-matplotlib-questions"><a href="/book/chapter-7-matplotlib/questions/">Questions</a></li><li class="
               "
        id="book-chapter-7-matplotlib-problems"><a href="/book/chapter-7-matplotlib/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-8-scipy"><a href="/book/chapter-8-scipy/">Chapter 8: SciPy</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-8-scipy-examples"><a href="/book/chapter-8-scipy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-questions"><a href="/book/chapter-8-scipy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-8-scipy-problems"><a href="/book/chapter-8-scipy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-examples"><a href="/book/chapter-8-scipy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-problems"><a href="/book/chapter-8-scipy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-9-general-scientific-programming"><a href="/book/chapter-9-general-scientific-programming/">Chapter 9: General Scientific Programming</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-9-general-scientific-programming-examples"><a href="/book/chapter-9-general-scientific-programming/examples/">Examples</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-questions"><a href="/book/chapter-9-general-scientific-programming/questions/">Questions</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-problems"><a href="/book/chapter-9-general-scientific-programming/problems/">Problems</a></li></ul></li><li class="
               "
        id="book-errata"><a href="/book/errata/">Errata</a></li></ul></li><li class="
               active"
        id="blog"><a href="/blog/"
        >
            Blog
            
        </a></li><li class="
               "
        id="apps"><a href="/apps/"
        >
            Apps
            
        </a></li><li class="
               "
        id="contact"><a href="/contact/"
        >
            Contact
            
        </a></li></ul>

</div>
</div>
</div>

<div class="container">





<ul class="breadcrumb">
<li id="breadcrumb-menu-home"><a href="/">Home</a></li><li id="breadcrumb-menu-blog"><a href="/blog/">Blog</a></li><li class="active">Impact craters on Earth</li>
</ul>

<h1>
Impact craters on Earth
</h1>

</div>

<div class="container">
<div class="row">

<div class="col-md-12 middle" style="max-width: 760px;">
    



<h6 class="post-meta">
    Posted by:
    
    <a href="/blog/author/christian/">christian</a> on
    
    28 Jul 2019
</h6>



<p>
    
        (<a href="#comments">0 comments</a>)
        
    
</p>






<p>The <a href="http://www.passc.net/EarthImpactDatabase/New%20website_05-2018/Index.html">Earth Impact Database</a> is a collection of images, publications and abstracts that provides information about confirmed impact structures for the scientific community. It is hosted at the <a href="http://www.passc.net/AboutUs/index.html">Planetary and Space Science Centre (PASSC)</a> of the <a href="https://www.unb.ca/">University of New Brunswick</a>.</p>
<p><img alt="enter image description here" class="fig" src="/static/media/uploads/blog/impact-craters/earth-impact-events.png"></p>
<div class="codehilite"><pre><span></span>Oldest crater: Suavjärvi (63.1, 33.4), 16.0 km, 2400.0 Ma
--
Largest impact crater in North America:
Chicxulub (21.3, -88.5), 150.0 km, 64.98 Ma
--
Largest impact crater in South America:
Araguainha (-15.2, -51.0), 40.0 km, 254.7 Ma
--
Largest impact crater in Europe:
Siljan (61.0, 14.9), 52.0 km, 376.8 Ma
--
Largest impact crater in Asia:
Popigai (71.7, 111.2), 90.0 km, 35.7 Ma
--
Largest impact crater in Africa:
Vredefort (-27.0, 27.5), 160.0 km, 2023.0 Ma
--
Largest impact crater in Australia:
Acraman (-32.0, 135.4), 90.0 km, 590.0 Ma
</pre></div>


<p>The code is also presented in <a href="https://github.com/xnx/impact-craters/blob/master/Earth%20Impact%20Craters.ipynb">a Jupyter Notebook</a> on <a href="https://github.com/xnx/impact-craters">this github repository</a>.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">geopandas</span>

<span class="c1"># The directory we're going to save local copies of the HTML files into.</span>
<span class="n">HTML_DIR</span> <span class="o">=</span> <span class="s1">'html'</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">HTML_DIR</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">HTML_DIR</span><span class="p">)</span>

<span class="c1"># The URLs for the HTML files at the online Earth Impact Database (EID).</span>
<span class="n">BASE_URL</span> <span class="o">=</span> <span class="s1">'http://www.passc.net/EarthImpactDatabase/New%20website_05-2018/'</span>
<span class="n">urls</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'North America'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'NorthAmerica.html'</span><span class="p">,</span>
        <span class="s1">'South America'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'SouthAmerica.html'</span><span class="p">,</span>
        <span class="s1">'Europe'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'Europe.html'</span><span class="p">,</span>
        <span class="s1">'Asia'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'AsiaRussia.html'</span><span class="p">,</span>
        <span class="s1">'Africa'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'Africa.html'</span><span class="p">,</span>
        <span class="s1">'Australia'</span><span class="p">:</span> <span class="n">BASE_URL</span> <span class="o">+</span> <span class="s1">'Australia.html'</span>
       <span class="p">}</span>
<span class="c1"># Make a dictionary of local filenames (without path). Use the same filename as</span>
<span class="c1"># on the EID server.</span>
<span class="n">filenames</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">((</span><span class="n">continent</span><span class="p">,</span>
                  <span class="n">url</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">continent</span> <span class="p">,</span><span class="n">url</span> <span class="ow">in</span> <span class="n">urls</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

<span class="k">def</span> <span class="nf">get_htmlpath</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""Get qualified path to local HTML file filename."""</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">HTML_DIR</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fetch_html</span><span class="p">(</span><span class="n">continent</span><span class="p">,</span> <span class="n">filename</span><span class="p">):</span>
    <span class="sd">"""Fetch HTML file for continent from internet and save as filename."""</span>

    <span class="k">print</span><span class="p">(</span><span class="s1">'Fetching HTML file'</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">urls</span><span class="p">[</span><span class="n">continent</span><span class="p">]</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">get_htmlpath</span><span class="p">(</span><span class="n">filename</span><span class="p">),</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fo</span><span class="p">:</span>
        <span class="n">fo</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>

<span class="c1"># Fetch the HTML into local files if we don't have them already.</span>
<span class="k">for</span> <span class="n">continent</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">get_htmlpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)):</span>
        <span class="n">fetch_html</span><span class="p">(</span><span class="n">continent</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">parse_latlong</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">"""Parse an angle in degrees and minutes into a decimal float."""</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'N'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'S'</span><span class="p">,</span><span class="s1">'-'</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'W'</span><span class="p">,</span><span class="s1">'-'</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'E'</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">' '</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">"'"</span><span class="p">,</span><span class="s1">''</span><span class="p">)</span>
    <span class="n">d</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'°'</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="nb">float</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span>

<span class="k">def</span> <span class="nf">parse_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">"""Parse s into a float if possible, ignoring asterisks."""</span>

    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'coerce'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">parse_age</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="sd">"""Parse s into a crater age if possible, handling uncertainties."""</span>

    <span class="n">note</span> <span class="o">=</span> <span class="s1">''</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'*'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">'&lt;'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s1">'upper bound'</span>
    <span class="k">elif</span> <span class="s1">'&gt;'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s1">'lower bound'</span>
    <span class="k">elif</span> <span class="s1">'~'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="s1">'approximate age'</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&lt;'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'&gt;'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'~'</span><span class="p">,</span> <span class="s1">''</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">'±'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">age</span><span class="p">,</span> <span class="n">unc</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'±'</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">age</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">unc</span><span class="p">),</span> <span class="n">note</span>
    <span class="k">elif</span> <span class="s1">'-'</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">lower_age</span><span class="p">,</span> <span class="n">upper_age</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'-'</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">lower_age</span><span class="p">,</span> <span class="n">upper_age</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">lower_age</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">upper_age</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">'parsing age failed'</span>
        <span class="n">mean_age</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower_age</span> <span class="o">+</span> <span class="n">upper_age</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="n">unc</span> <span class="o">=</span> <span class="n">mean_age</span> <span class="o">-</span> <span class="n">lower_age</span>
        <span class="k">return</span> <span class="n">mean_age</span><span class="p">,</span> <span class="n">unc</span><span class="p">,</span> <span class="n">note</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">note</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="s1">'parsing age failed'</span>

<span class="k">def</span> <span class="nf">read_html_to_pd</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">filepath</span> <span class="o">=</span> <span class="n">get_htmlpath</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># It's the second table we want.</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_html</span><span class="p">(</span><span class="n">filepath</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># The column names have been put in the first row: fix this.</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

    <span class="c1"># Convert longitude and latitude strings to floats</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Longitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Longitude'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_latlong</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Latitude'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Latitude'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_latlong</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Diameter (km)'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Diameter (km)'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_numeric</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Age (Ma)*'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Age unc. (Ma)'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Note'</span><span class="p">]</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span>
                                <span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">'Age (Ma)*'</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">parse_age</span><span class="p">))</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Exposed'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Exposed'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Y'</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">'Drilled'</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Drilled'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'Y'</span>
    <span class="k">return</span> <span class="n">df</span>

<span class="n">dd</span> <span class="o">=</span> <span class="p">{}</span>
<span class="c1"># Parse the HTML tables for the data, for each continent</span>
<span class="k">for</span> <span class="n">continent</span><span class="p">,</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">dd</span><span class="p">[</span><span class="n">continent</span><span class="p">]</span> <span class="o">=</span> <span class="n">read_html_to_pd</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dd</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">crater_summary</span><span class="p">(</span><span class="n">crater</span><span class="p">):</span>
    <span class="sd">"""Return a string summarizing the important features of crater."""</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="s2">"{crater['Crater Name']} "</span>
            <span class="n">f</span><span class="s2">"({crater['Latitude']:.1f}, {crater['Longitude']:.1f})"</span>
            <span class="n">f</span><span class="s2">", {crater['Diameter (km)']} km, {crater['Age (Ma)*']} Ma"</span><span class="p">)</span>

<span class="n">i_oldest</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Age (Ma)*'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="s1">'Oldest crater:'</span><span class="p">,</span> <span class="n">crater_summary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i_oldest</span><span class="p">]))</span>

<span class="k">for</span> <span class="n">continent</span> <span class="ow">in</span> <span class="n">filenames</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">i_largest</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">continent</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s1">'Diameter (km)'</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'--'</span><span class="p">)</span>
    <span class="k">print</span><span class="p">(</span><span class="s1">'Largest impact crater in {}:'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">continent</span><span class="p">))</span>
    <span class="k">print</span><span class="p">(</span><span class="n">crater_summary</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">continent</span><span class="p">]</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">i_largest</span><span class="p">]))</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s1">'equal'</span><span class="p">)</span>

<span class="n">world</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="n">geopandas</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_path</span><span class="p">(</span><span class="s1">'naturalearth_lowres'</span><span class="p">))</span>
<span class="n">world</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">sizes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">df</span><span class="p">[</span><span class="s1">'Diameter (km)'</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">'Longitude'</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="s1">'Latitude'</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">sizes</span><span class="p">,</span>
           <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'none'</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">'off'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>









<div class="panel panel-default rating">
    <div class="panel-body">
    

<span id="rating-124">
    
    Current rating: 5
    
</span>


<form class="form-inline" role="form" method="post" action="/rating/">
    
    <input type='hidden' name='csrfmiddlewaretoken' value='k52WLux8oESBU0pwgfrtP2hkTIcoUze6j2cdn0oDSwnSGNOWIu4l849xCaVUX5I5' />
    
    <ul class="radio radio-inline"><li> <ul id="id_value"><li><label for="id_value_0"><input id="id_value_0" name="value" type="radio" value="1" required /> 1</label></li>
<li><label for="id_value_1"><input id="id_value_1" name="value" type="radio" value="2" required /> 2</label></li>
<li><label for="id_value_2"><input id="id_value_2" name="value" type="radio" value="3" required /> 3</label></li>
<li><label for="id_value_3"><input id="id_value_3" name="value" type="radio" value="4" required /> 4</label></li>
<li><label for="id_value_4"><input id="id_value_4" name="value" type="radio" value="5" required /> 5</label></li></ul><input id="id_content_type" name="content_type" type="hidden" value="blog.blogpost" /><input id="id_object_pk" name="object_pk" type="hidden" value="124" /><input id="id_timestamp" name="timestamp" type="hidden" value="1595058385" /><input id="id_security_hash" maxlength="40" minlength="40" name="security_hash" type="hidden" value="134bf396c705c2702e28f912f62a4dc3343d74bc" /></li></ul>
    <input type="submit" class="btn btn-default btn-sm" value="Rate"
        onclick="return $(this.form).find('input:checked').length == 1;">
</form>


    </div>
</div>




<a class="btn btn-sm share-twitter" target="_blank" href="http://twitter.com/home?status=https%3A//scipython.com/blog/impact-craters-on-earth/%20Impact%20craters%20on%20Earth">Share on Twitter</a>
<a class="btn btn-sm share-facebook" target="_blank" href="http://facebook.com/sharer.php?u=https://scipython.com/blog/impact-craters-on-earth/&amp;t=Impact%20craters%20on%20Earth">Share on Facebook</a>



<ul class="pager">


<li class="previous">
    <a href="/blog/the-star-wars-opening-crawl-in-matplotlib/">&larr; The Star Wars opening crawl in Matplotlib</a>
</li>




<li class="next">
    <a href="/blog/some-analysis-of-the-demographics-of-india/">Some analysis of the demographics of India &rarr;</a>
</li>


</ul>








<div id="comments">
<h3>Comments</h3>
<p>Comments are pre-moderated. Please be patient and your comment will appear soon.</p>

<script>
$(function() {
    $('.reply').click(function() {
        $('.comment-reply-form').hide();
        $(this).siblings('.comment-reply-form').toggle();
    });
});
</script>
<style>.input_id_honeypot {display:none !important;}</style>





<p>There are currently no comments</p>



<h3>New Comment</h3>
<form method="post" id="comment" action="/comment/#comment">
    
    



<input type="hidden" name="referrer" value="https://scipython.com/">
<input type='hidden' name='csrfmiddlewaretoken' value='k52WLux8oESBU0pwgfrtP2hkTIcoUze6j2cdn0oDSwnSGNOWIu4l849xCaVUX5I5' />




<input id="id_content_type" name="content_type" type="hidden" value="blog.blogpost" />



<input id="id_object_pk" name="object_pk" type="hidden" value="124" />



<input id="id_timestamp" name="timestamp" type="hidden" value="1595058385" />



<input id="id_security_hash" maxlength="40" minlength="40" name="security_hash" type="hidden" value="134bf396c705c2702e28f912f62a4dc3343d74bc" />



<div class="form-group input_id_name 
    ">
    <label class="control-label" for="id_name">Name</label>
    <input id="id_name" maxlength="50" name="name" type="text" required />
    
    <p class="help-block">required</p>
    
</div>



<div class="form-group input_id_email 
    ">
    <label class="control-label" for="id_email">Email</label>
    <input id="id_email" name="email" type="email" required />
    
    <p class="help-block">required (not published)</p>
    
</div>



<div class="form-group input_id_url 
    ">
    <label class="control-label" for="id_url">Website</label>
    <input id="id_url" name="url" type="url" />
    
    <p class="help-block">optional</p>
    
</div>



<div class="form-group input_id_comment 
    ">
    <label class="control-label" for="id_comment">Comment</label>
    <textarea cols="40" id="id_comment" maxlength="3000" name="comment" rows="10" required>
</textarea>
    
    <p class="help-block">required</p>
    
</div>



<div class="form-group input_id_honeypot 
    ">
    <label class="control-label" for="id_honeypot">If you enter anything in this field your comment will be treated as spam</label>
    <input id="id_honeypot" name="honeypot" type="text" />
    
</div>



    
    <div class="form-actions">
        <input class="btn btn-primary btn-lg" type="submit" value="Comment">
    </div>
</form>

</div>




</div>

</div>
</div>

<footer>
<div class="container">
</div>
</footer>








<script>

var _gaq = _gaq || [['_trackPageview']];
_gaq.unshift(['_setAccount', 'UA-91424547-3']);
(function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = '//www.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
})(document, 'script');

</script>


</body>
</html>
