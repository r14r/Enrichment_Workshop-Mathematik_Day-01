<!doctype html>
<html lang="en">


<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="">
<meta name="description" content="The use of np.loadtxt is best illustrated using an example. Consider the following text file of data relating to a (fictional) population of students. This file can be downloaded as eg6-a-student-data.txt.">
<title>Using NumPy&#39;s loadtxt method</title>
<link rel="shortcut icon" href="/static/img/favicon.ico">


<link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feeds/rss/">
<link rel="alternate" type="application/atom+xml" title="Atom" href="/blog/feeds/atom/">



<link rel="stylesheet" href="/static/css/bootstrap.css">
<link rel="stylesheet" href="/static/css/mezzanine.css">
<link rel="stylesheet" href="/static/css/codehilite.css">
<link rel="stylesheet" href="/static/css/custom.css">






<script src="/static/mezzanine/js/jquery-1.8.3.min.js"></script>
<script src="/static/js/bootstrap.js"></script>
<script src="/static/js/bootstrap-extras.js"></script>



<!--[if lt IE 9]>
<script src="/static/js/html5shiv.js"></script>
<script src="/static/js/respond.min.js"></script>
<![endif]-->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body id="body">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle Navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
    
    
</div>
<div class="navbar-collapse collapse">
    
<form action="/search/" class="navbar-form navbar-right" role="search">

<div class="form-group">
    <input class="form-control" placeholder="Search" type="text" name="q" value="">
</div>


    
    <div class="form-group">
    <select class="form-control" name="type">
        <option value="">Everything</option>
        
        <option value="blog.BlogPost"
            >
            Blog posts
        </option>
        
        <option value="pages.Page"
            >
            Pages
        </option>
        
    </select>
    </div>
    


<input type="submit" class="btn btn-default" value="Go">

</form>

    
<ul class="nav navbar-nav"><li id="dropdown-menu-home"><a href="/">Home</a></li><li class="dropdown
               "
        id="about"><a href="/about/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            About
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="about-the-author"><a href="/about/the-author/">The Author</a></li><li class="
               "
        id="about-the-book"><a href="/about/the-book/">The Book</a></li><li class="
               "
        id="about-this-website"><a href="/about/this-website/">This Website</a></li></ul></li><li class="dropdown
               active"
        id="book"><a href="/book/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            Book
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-1-introduction"><a href="/book/chapter-1-introduction/">Chapter 1: Introduction</a></li><li class="dropdown-submenu
               "
        id="book-chapter-2-the-core-python-language-i"><a href="/book/chapter-2-the-core-python-language-i/">Chapter 2: The Core Python Language I</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-2-the-core-python-language-i-examples"><a href="/book/chapter-2-the-core-python-language-i/examples/">Examples</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions"><a href="/book/chapter-2-the-core-python-language-i/questions/">Questions</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions-problems"><a href="/book/chapter-2-the-core-python-language-i/questions/problems/">Problems</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-additional-problems"><a href="/book/chapter-2-the-core-python-language-i/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-3-simple-plotting-with-pylab"><a href="/book/chapter-3-simple-plotting-with-pylab/">Chapter 3: Simple Plotting with pylab</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-examples"><a href="/book/chapter-3-simple-plotting-with-pylab/examples/">Examples</a></li><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-problems"><a href="/book/chapter-3-simple-plotting-with-pylab/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-4-the-core-python-language-ii"><a href="/book/chapter-4-the-core-python-language-ii/">Chapter 4: The core Python language II</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-examples"><a href="/book/chapter-4-the-core-python-language-ii/examples/">Examples</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-questions"><a href="/book/chapter-4-the-core-python-language-ii/questions/">Questions</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-problems"><a href="/book/chapter-4-the-core-python-language-ii/problems/">Problems</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-additional-problems"><a href="/book/chapter-4-the-core-python-language-ii/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-5-ipython-and-ipython-notebook"><a href="/book/chapter-5-ipython-and-ipython-notebook/">Chapter 5: IPython and IPython Notebook</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-5-ipython-and-ipython-notebook-examples"><a href="/book/chapter-5-ipython-and-ipython-notebook/examples/">Examples</a></li></ul></li><li class="dropdown-submenu
               active"
        id="book-chapter-6-numpy"><a href="/book/chapter-6-numpy/">Chapter 6: NumPy</a><ul class="dropdown-menu"><li class="
               active"
        id="book-chapter-6-numpy-examples"><a href="/book/chapter-6-numpy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-questions"><a href="/book/chapter-6-numpy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-6-numpy-problems"><a href="/book/chapter-6-numpy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-examples"><a href="/book/chapter-6-numpy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-problems"><a href="/book/chapter-6-numpy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-7-matplotlib"><a href="/book/chapter-7-matplotlib/">Chapter 7: Matplotlib</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-7-matplotlib-examples"><a href="/book/chapter-7-matplotlib/examples/">Examples</a></li><li class="
               "
        id="book-chapter-7-matplotlib-questions"><a href="/book/chapter-7-matplotlib/questions/">Questions</a></li><li class="
               "
        id="book-chapter-7-matplotlib-problems"><a href="/book/chapter-7-matplotlib/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-8-scipy"><a href="/book/chapter-8-scipy/">Chapter 8: SciPy</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-8-scipy-examples"><a href="/book/chapter-8-scipy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-questions"><a href="/book/chapter-8-scipy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-8-scipy-problems"><a href="/book/chapter-8-scipy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-examples"><a href="/book/chapter-8-scipy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-problems"><a href="/book/chapter-8-scipy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-9-general-scientific-programming"><a href="/book/chapter-9-general-scientific-programming/">Chapter 9: General Scientific Programming</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-9-general-scientific-programming-examples"><a href="/book/chapter-9-general-scientific-programming/examples/">Examples</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-questions"><a href="/book/chapter-9-general-scientific-programming/questions/">Questions</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-problems"><a href="/book/chapter-9-general-scientific-programming/problems/">Problems</a></li></ul></li><li class="
               "
        id="book-errata"><a href="/book/errata/">Errata</a></li></ul></li><li class="
               "
        id="blog"><a href="/blog/"
        >
            Blog
            
        </a></li><li class="
               "
        id="apps"><a href="/apps/"
        >
            Apps
            
        </a></li><li class="
               "
        id="contact"><a href="/contact/"
        >
            Contact
            
        </a></li></ul>

</div>
</div>
</div>

<div class="container">





<ul class="breadcrumb">
<li id="breadcrumb-menu-home"><a href="/">Home</a></li><li id="breadcrumb-menu-book"><a href="/book/">Book</a></li><li id="breadcrumb-menu-book-chapter-6-numpy"><a href="/book/chapter-6-numpy/">Chapter 6: NumPy</a></li><li id="breadcrumb-menu-book-chapter-6-numpy-examples"><a href="/book/chapter-6-numpy/examples/">Examples</a></li><li id="breadcrumb-menu-book-chapter-6-numpy-examples-using-numpys-loadtxt-method"
        class="active">Using NumPy&#39;s loadtxt method</li>
</ul>

<h1>
Using NumPy&#39;s loadtxt method</h1>

</div>

<div class="container">
<div class="row">

<div class="col-md-12 middle" style="max-width: 760px;">
    

<p>The use of <code>np.loadtxt</code> is best illustrated using an example. Consider the following text file of data relating to a (fictional) population of students. This file can be downloaded as <a href="/static/media/examples/E6/eg6-a-student-data.txt"><code>eg6-a-student-data.txt</code></a>.</p>
<div class="codehilite"><pre><span></span># Student data collected on 17 July 2014.
# Researcher: Dr Wicks, University College Newbury.

# The following data relate to N = 20 students. It
# has been totally made up and so therefore is 100%
# anonymous.

Subject Sex    DOB      Height  Weight       BP     VO2max
(ID)    M/F  dd/mm/yy     m       kg        mmHg  mL.kg-1.min-1
JW-1     M    19/12/95    1.82     92.4    119/76   39.3
JW-2     M    11/1/96     1.77     80.9    114/73   35.5
JW-3     F    2/10/95     1.68     69.7    124/79   29.1
JW-6     M    6/7/95      1.72     75.5    110/60   45.5
# JW-7    F    28/3/96     1.66     72.4    101/68   -
JW-9     F    11/12/95    1.78     82.1    115/75   32.3
JW-10    F    7/4/96      1.60     -       -/-      30.1
JW-11    M    22/8/95     1.72     77.2    97/63    48.8
JW-12    M    23/5/96     1.83     88.9    105/70   37.7
JW-14    F    12/1/96     1.56     56.3    108/72   26.0
JW-15    F    1/6/96      1.64     65.0    99/67    35.7
JW-16    M    10/9/95     1.63     73.0    131/84   29.9
JW-17    M    17/2/96     1.67     89.8    101/76   40.2
JW-18    M    31/7/96     1.66     75.1    -/-      -
JW-19    F    30/10/95    1.59     67.3    103/69   33.5
JW-22    F    9/3/96      1.70     -       119/80   30.9
JW-23    M    15/5/95     1.97     89.2    124/82   -
JW-24    F    1/12/95     1.66     63.8    100/78   -
JW-25    F    25/10/95    1.63     64.4    -/-      28.0
JW-26    M    17/4/96     1.69     -       121/82   39.
</pre></div>


<p>Let's find the average heights of the male and female students. The columns we need are the second and fourth, and there's no missing data in these columns so we can use <code>np.loadtxt</code>. First construct a record <code>dtype</code> for the two fields, then read the relevant columns after skipping the first 9 header lines:</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">fname</span> <span class="o">=</span> <span class="s1">'eg6-a-student-data.txt'</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">dtype1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">'gender'</span><span class="p">,</span> <span class="s1">'|S1'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="s1">'f8'</span><span class="p">)])</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype1</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([(</span><span class="sa">b</span><span class="s1">'M'</span><span class="p">,</span> <span class="mf">1.8200000524520874</span><span class="p">),</span> <span class="p">(</span><span class="sa">b</span><span class="s1">'M'</span><span class="p">,</span> <span class="mf">1.7699999809265137</span><span class="p">),</span>
       <span class="p">(</span><span class="sa">b</span><span class="s1">'F'</span><span class="p">,</span> <span class="mf">1.6799999475479126</span><span class="p">),</span> <span class="p">(</span><span class="sa">b</span><span class="s1">'M'</span><span class="p">,</span> <span class="mf">1.7200000286102295</span><span class="p">),</span>
       <span class="o">...</span>
       <span class="p">(</span><span class="sa">b</span><span class="s1">'M'</span><span class="p">,</span> <span class="mf">1.690000057220459</span><span class="p">)],</span> 
      <span class="n">dtype</span><span class="o">=</span><span class="p">[(</span><span class="s1">'gender'</span><span class="p">,</span> <span class="s1">'S1'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'height'</span><span class="p">,</span> <span class="s1">'&lt;f8'</span><span class="p">)])</span>
</pre></div>


<p>To find the average heights of the male students, we only want to index the records with the gender field as <code>M</code>, for which we can create a boolean array:</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">m</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s1">'gender'</span><span class="p">]</span> <span class="o">==</span> <span class="sa">b</span><span class="s1">'M'</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">m</span>
<span class="n">Out</span><span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">array</span><span class="p">([</span> <span class="bp">True</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span> <span class="bp">False</span><span class="p">,</span>  <span class="bp">True</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span>  <span class="bp">True</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
</pre></div>


<p><code>m</code> has entries that are <code>True</code> or <code>False</code> for each of the 19 valid records (one is commented out) according to whether the student is male or female. So the heights of the male students can be seen to be:</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="s1">'height'</span><span class="p">][</span><span class="n">m</span><span class="p">])</span>
<span class="p">[</span> <span class="mf">1.82000005</span>  <span class="mf">1.76999998</span>  <span class="mf">1.72000003</span>  <span class="mf">1.72000003</span>  <span class="mf">1.83000004</span>  <span class="mf">1.63</span>
  <span class="mf">1.66999996</span>  <span class="mf">1.65999997</span>  <span class="mf">1.97000003</span>  <span class="mf">1.69000006</span><span class="p">]</span>
</pre></div>


<p>Therefore, the averages we need are</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">m_av</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s1">'height'</span><span class="p">][</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">f_av</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="s1">'height'</span><span class="p">][</span><span class="o">~</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="s1">'Male average: {:.2f} m, Female average: {:.2f} m'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_av</span><span class="p">,</span><span class="n">f_av</span><span class="p">))</span>
<span class="n">Male</span> <span class="n">average</span><span class="p">:</span> <span class="mf">1.75</span> <span class="n">m</span><span class="p">,</span> <span class="n">Female</span> <span class="n">average</span><span class="p">:</span> <span class="mf">1.65</span> <span class="n">m</span>
</pre></div>


<p>Note that <code>~m</code> ("not <code>m</code>") is the inverse boolean array of <code>m</code>.</p>
<p>To perform the same analysis on the student weights we have a bit more work to do because there are some missing values (denoted by '<code>-</code>'). We could use <code>np.genfromtxt</code> (see Section 6.2.3 of the book), but let's write a converter method instead. We'll replace the missing values with the nicely unphysical value of -99. The function <code>parse_weight</code> expects a string argument and returns a <code>float</code>:</p>
<div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_weight</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">99.</span>
</pre></div>


<p>This is the function we want to pass as a converter for column 4:</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">dtype2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">'gender'</span><span class="p">,</span> <span class="s1">'|S1'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'weight'</span><span class="p">,</span> <span class="s1">'f8'</span><span class="p">)])</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">fname</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype2</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span>
                       <span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="mi">4</span><span class="p">:</span> <span class="n">parse_weight</span><span class="p">})</span>
</pre></div>


<p>Now mask off the invalid data and index the array with a boolean array as before:</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">mv</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span>    <span class="c1"># elements only True for valid data</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">m_wav</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">][</span><span class="n">mv</span> <span class="o">&amp;</span> <span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>      <span class="c1"># valid and male</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">f_wav</span> <span class="o">=</span> <span class="n">b</span><span class="p">[</span><span class="s1">'weight'</span><span class="p">][</span><span class="n">mv</span> <span class="o">&amp;</span> <span class="o">~</span><span class="n">m</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>     <span class="c1"># valid and female</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="s1">'Male average: {:.2f} kg, Female average: {:.2f} kg'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m_wav</span><span class="p">,</span><span class="n">f_wav</span><span class="p">))</span>
<span class="n">Male</span> <span class="n">average</span><span class="p">:</span> <span class="mf">82.44</span> <span class="n">kg</span><span class="p">,</span> <span class="n">Female</span> <span class="n">average</span><span class="p">:</span> <span class="mf">66.94</span> <span class="n">kg</span>
</pre></div>


<p>Finally, let's read in the blood pressure data. Here we have a problem, because the systolic and diastolic pressures are not separated by whitespace but by a forward slash (<code>/</code>). One solution is to reformat each line to replace the slash with a space before it is fed to <code>np.loadtxt</code>. Recall that <code>fname</code> can be a generator instead of a filename or open file: we write a suitable generator function, <code>reformat_lines</code>, which takes an open file object and yields its lines to <code>np.loadtxt</code>, one by one, after the replacement. This is going to mess with the column numbering because it has the side effect of splitting up the birth dates into three columns, so in our reformatted lines the blood pressure values are now in the columns indexed at 7 and 8.</p>
<div class="codehilite"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>

<span class="n">fname</span> <span class="o">=</span> <span class="s1">'eg6-a-student-data.txt'</span>
<span class="n">dtype3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">([(</span><span class="s1">'gender'</span><span class="p">,</span> <span class="s1">'|S1'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'bps'</span><span class="p">,</span> <span class="s1">'f8'</span><span class="p">),</span> <span class="p">(</span><span class="s1">'bpd'</span><span class="p">,</span> <span class="s1">'f8'</span><span class="p">)])</span>

<span class="k">def</span> <span class="nf">parse_bp</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mf">99.</span>

<span class="k">def</span> <span class="nf">reformat_lines</span><span class="p">(</span><span class="n">fi</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">fi</span><span class="p">:</span>
        <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'/'</span><span class="p">,</span><span class="s1">' '</span><span class="p">)</span>
        <span class="k">yield</span> <span class="n">line</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="k">as</span> <span class="n">fi</span><span class="p">:</span>
    <span class="n">gender</span><span class="p">,</span> <span class="n">bps</span><span class="p">,</span> <span class="n">bpd</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">reformat_lines</span><span class="p">(</span><span class="n">fi</span><span class="p">),</span> <span class="n">dtype3</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span>
                <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">),</span><span class="n">converters</span><span class="o">=</span><span class="p">{</span><span class="mi">7</span><span class="p">:</span> <span class="n">parse_bp</span><span class="p">,</span> <span class="mi">8</span><span class="p">:</span> <span class="n">parse_bp</span><span class="p">},</span>
                <span class="n">unpack</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c1"># now do something with the data...</span>
</pre></div>


</div>

</div>
</div>

<footer>
<div class="container">
</div>
</footer>








<script>

var _gaq = _gaq || [['_trackPageview']];
_gaq.unshift(['_setAccount', 'UA-91424547-3']);
(function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = '//www.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
})(document, 'script');

</script>


</body>
</html>
