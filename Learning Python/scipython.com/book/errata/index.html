<!doctype html>
<html lang="en">


<head>
<meta http-equiv="Content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="">
<meta name="description" content="Corrections and clarifications to the text of the printed version of the book appear here. Special thanks to Stafford Baines, Stuart Anderson and Matthew Gillman for reporting so many of these.">
<title>Errata</title>
<link rel="shortcut icon" href="/static/img/favicon.ico">


<link rel="alternate" type="application/rss+xml" title="RSS" href="/blog/feeds/rss/">
<link rel="alternate" type="application/atom+xml" title="Atom" href="/blog/feeds/atom/">



<link rel="stylesheet" href="/static/css/bootstrap.css">
<link rel="stylesheet" href="/static/css/mezzanine.css">
<link rel="stylesheet" href="/static/css/codehilite.css">
<link rel="stylesheet" href="/static/css/custom.css">






<script src="/static/mezzanine/js/jquery-1.8.3.min.js"></script>
<script src="/static/js/bootstrap.js"></script>
<script src="/static/js/bootstrap-extras.js"></script>



<!--[if lt IE 9]>
<script src="/static/js/html5shiv.js"></script>
<script src="/static/js/respond.min.js"></script>
<![endif]-->



<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
});
</script>
<script type="text/javascript"
  src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


</head>

<body id="body">

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
<div class="container">
<div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle Navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
    
    
</div>
<div class="navbar-collapse collapse">
    
<form action="/search/" class="navbar-form navbar-right" role="search">

<div class="form-group">
    <input class="form-control" placeholder="Search" type="text" name="q" value="">
</div>


    
    <div class="form-group">
    <select class="form-control" name="type">
        <option value="">Everything</option>
        
        <option value="blog.BlogPost"
            >
            Blog posts
        </option>
        
        <option value="pages.Page"
            >
            Pages
        </option>
        
    </select>
    </div>
    


<input type="submit" class="btn btn-default" value="Go">

</form>

    
<ul class="nav navbar-nav"><li id="dropdown-menu-home"><a href="/">Home</a></li><li class="dropdown
               "
        id="about"><a href="/about/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            About
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="about-the-author"><a href="/about/the-author/">The Author</a></li><li class="
               "
        id="about-the-book"><a href="/about/the-book/">The Book</a></li><li class="
               "
        id="about-this-website"><a href="/about/this-website/">This Website</a></li></ul></li><li class="dropdown
               active"
        id="book"><a href="/book/"
        
        class="dropdown-toggle disabled" data-toggle="dropdown"
        >
            Book
            <b class="caret"></b></a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-1-introduction"><a href="/book/chapter-1-introduction/">Chapter 1: Introduction</a></li><li class="dropdown-submenu
               "
        id="book-chapter-2-the-core-python-language-i"><a href="/book/chapter-2-the-core-python-language-i/">Chapter 2: The Core Python Language I</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-2-the-core-python-language-i-examples"><a href="/book/chapter-2-the-core-python-language-i/examples/">Examples</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions"><a href="/book/chapter-2-the-core-python-language-i/questions/">Questions</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-questions-problems"><a href="/book/chapter-2-the-core-python-language-i/questions/problems/">Problems</a></li><li class="
               "
        id="book-chapter-2-the-core-python-language-i-additional-problems"><a href="/book/chapter-2-the-core-python-language-i/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-3-simple-plotting-with-pylab"><a href="/book/chapter-3-simple-plotting-with-pylab/">Chapter 3: Simple Plotting with pylab</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-examples"><a href="/book/chapter-3-simple-plotting-with-pylab/examples/">Examples</a></li><li class="
               "
        id="book-chapter-3-simple-plotting-with-pylab-problems"><a href="/book/chapter-3-simple-plotting-with-pylab/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-4-the-core-python-language-ii"><a href="/book/chapter-4-the-core-python-language-ii/">Chapter 4: The core Python language II</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-examples"><a href="/book/chapter-4-the-core-python-language-ii/examples/">Examples</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-questions"><a href="/book/chapter-4-the-core-python-language-ii/questions/">Questions</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-problems"><a href="/book/chapter-4-the-core-python-language-ii/problems/">Problems</a></li><li class="
               "
        id="book-chapter-4-the-core-python-language-ii-additional-problems"><a href="/book/chapter-4-the-core-python-language-ii/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-5-ipython-and-ipython-notebook"><a href="/book/chapter-5-ipython-and-ipython-notebook/">Chapter 5: IPython and IPython Notebook</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-5-ipython-and-ipython-notebook-examples"><a href="/book/chapter-5-ipython-and-ipython-notebook/examples/">Examples</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-6-numpy"><a href="/book/chapter-6-numpy/">Chapter 6: NumPy</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-6-numpy-examples"><a href="/book/chapter-6-numpy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-questions"><a href="/book/chapter-6-numpy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-6-numpy-problems"><a href="/book/chapter-6-numpy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-examples"><a href="/book/chapter-6-numpy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-6-numpy-additional-problems"><a href="/book/chapter-6-numpy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-7-matplotlib"><a href="/book/chapter-7-matplotlib/">Chapter 7: Matplotlib</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-7-matplotlib-examples"><a href="/book/chapter-7-matplotlib/examples/">Examples</a></li><li class="
               "
        id="book-chapter-7-matplotlib-questions"><a href="/book/chapter-7-matplotlib/questions/">Questions</a></li><li class="
               "
        id="book-chapter-7-matplotlib-problems"><a href="/book/chapter-7-matplotlib/problems/">Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-8-scipy"><a href="/book/chapter-8-scipy/">Chapter 8: SciPy</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-8-scipy-examples"><a href="/book/chapter-8-scipy/examples/">Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-questions"><a href="/book/chapter-8-scipy/questions/">Questions</a></li><li class="
               "
        id="book-chapter-8-scipy-problems"><a href="/book/chapter-8-scipy/problems/">Problems</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-examples"><a href="/book/chapter-8-scipy/additional-examples/">Additional Examples</a></li><li class="
               "
        id="book-chapter-8-scipy-additional-problems"><a href="/book/chapter-8-scipy/additional-problems/">Additional Problems</a></li></ul></li><li class="dropdown-submenu
               "
        id="book-chapter-9-general-scientific-programming"><a href="/book/chapter-9-general-scientific-programming/">Chapter 9: General Scientific Programming</a><ul class="dropdown-menu"><li class="
               "
        id="book-chapter-9-general-scientific-programming-examples"><a href="/book/chapter-9-general-scientific-programming/examples/">Examples</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-questions"><a href="/book/chapter-9-general-scientific-programming/questions/">Questions</a></li><li class="
               "
        id="book-chapter-9-general-scientific-programming-problems"><a href="/book/chapter-9-general-scientific-programming/problems/">Problems</a></li></ul></li><li class="
               active"
        id="book-errata"><a href="/book/errata/">Errata</a></li></ul></li><li class="
               "
        id="blog"><a href="/blog/"
        >
            Blog
            
        </a></li><li class="
               "
        id="apps"><a href="/apps/"
        >
            Apps
            
        </a></li><li class="
               "
        id="contact"><a href="/contact/"
        >
            Contact
            
        </a></li></ul>

</div>
</div>
</div>

<div class="container">





<ul class="breadcrumb">
<li id="breadcrumb-menu-home"><a href="/">Home</a></li><li id="breadcrumb-menu-book"><a href="/book/">Book</a></li><li id="breadcrumb-menu-book-errata"
        class="active">Errata</li>
</ul>

<h1>
Errata
</h1>

</div>

<div class="container">
<div class="row">

<div class="col-md-12 middle" style="max-width: 760px;">
    



<p>Corrections and clarifications to the text of the printed version of the book appear here. Special thanks to Stafford Baines, Stuart Anderson and Matthew Gillman for reporting so many of these.</p>
<hr>
<p>p. 10 (Example E2.1) The second note ① is a bit careless: <code>int</code> truncates a floating point number towards zero rather than "rounding down" in casting it to an integer. For example, <code>int(-1.4)</code> is <code>-1</code>, not <code>-2</code>.</p>
<hr>
<p>p. 17 (Table 2.4) The list of Python 3 keywords is incomplete: in addition to those given, <code>False</code>, <code>True</code>, <code>None</code>, <code>as</code> and <code>with</code> are reserved keywords. The identifier <code>print</code> is no longer a keyword in Python 3 but it does refer to the <code>print</code> function and so should be avoided as a variable name.</p>
<hr>
<p>p. 34 (E2.13) There is no space after <code>Fortran</code> in the string <code>b</code>, so this word will not get an exclamation mark after it as a result of <code>c = b.replace(' ', '!\n')</code>. This is correctly shown when the string literal <code>c</code> is echoed back at the command prompt, but the <code>print(c)</code> call following that incorrectly shows <code>Fortran!</code> as the fourth line of output.</p>
<hr>
<p>p. 41 (P2.3.4) The NASA page of planet symbols has moved to <a href="https://solarsystem.nasa.gov/resources/680/solar-system-symbols/">https://solarsystem.nasa.gov/resources/680/solar-system-symbols/</a>.</p>
<hr>
<p>p.55 (Q2.4.1) Some stray markup made its way into (d) which should read <code>print(*a, sep='')</code></p>
<hr>
<p>p. 56 (P2.4.7) The file defining the list of protein lengths to use in the second part of this exercise on Benford's Law is called <code>protein_lengths.py</code>, not <code>ex2-4_e_ii_protein_lengths.py</code>. It can be downloaded from <a href="/book/chapter-2-the-core-python-language-i/questions/problems/p24/benfords-law/">the online version of the exercise.</a>.</p>
<hr>
<p>p. 57 (end of page) <code>if ... elif ... endif</code> should read <code>if ... elif ... else</code>. There is no <code>endif</code> in Python.</p>
<hr>
<p>p. 76 (E2.28) There is a line of output missing between the two "<code>in global scope</code>" lines:</p>
<div class="codehilite"><pre><span></span>    in global scope, b is 7 (id=264)
</pre></div>


<hr>
<p>p. 76 (§2.7.4) "the it points to" $\rightarrow$ "the object it points to". This whole sentence should then read:</p>
<p>When a name is passed to a function, the "value" that is passed is, in fact, the object it points to.</p>
<hr>
<p>p. 89 (P3.1.3) There is a missing minus sign in the exponential defining the Gaussian function, which should read
$$
g(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left( -\frac{x^2}{2\sigma^2} \right).
$$
[Thanks to Ivan Yeung for spotting this typo].</p>
<hr>
<p>p. 90 The voltages given are the rms values and should be 230 V (UK) and 120 V (US); to get the peak-to-peak values for the plot, they should be multiplied by $\sqrt{2}$. In the listing, instead of:</p>
<div class="codehilite"><pre><span></span>Vp_uk, Vp_us = 230, 110
</pre></div>


<p>use</p>
<div class="codehilite"><pre><span></span>Vp_uk, Vp_us = 230 * pylab.sqrt(2), 120 * pylab.sqrt(2)
</pre></div>


<p>(or <code>np.sqrt(2)</code> if using NumPy directly).</p>
<p>[Thanks to Toshio Iguchi for spotting this mistake].</p>
<hr>
<p>p. 91 The URL in footnote 2 should be <a href="https://matplotlib.org/api/markers_api.html">https://matplotlib.org/api/markers_api.html</a>.</p>
<hr>
<p>p. 110 (P4.1.2) The code lines are missing their closing parantheses and should read:</p>
<div class="codehilite"><pre><span></span>&gt;&gt;&gt; print(str_vector([-2, 3.5]))
&gt;&gt;&gt; print(str_vector((4, 0.5, -2)))
</pre></div>


<hr>
<p>p. 151 The last format specifier in the <code>print</code> statement is incorrect. This line should read</p>
<div class="codehilite"><pre><span></span>print('The balance of account number {:d} is {:s}{:.2f}'
        .format(self.account_number, self.currency, self.balance))
</pre></div>


<hr>
<p>p. 207 The line</p>
<div class="codehilite"><pre><span></span>b.np.array([[0, 3, -2], [7, 1, 3], [4, 0, -1]])
</pre></div>


<p>should be</p>
<div class="codehilite"><pre><span></span>b = np.array([[0, 3, -2], [7, 1, 3], [4, 0, -1]])
</pre></div>


<hr>
<p>p. 216 (P6.1.3) There is a missing minus sign in the exponential defining the Gaussian function, which should read
$$
g(x) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left( -\frac{(x-\mu)^2}{2\sigma^2} \right)
$$
[Thanks to Ivan Yeung for spotting this typo].</p>
<hr>
<p>p. 218 (E6.6) The "missing data" entries in the blood pressure column should be <code>-/-</code> instead of <code>-</code> for Listing 6.4 on the following page to work properly.  [Thanks to Stafford Baines for spotting this].</p>
<hr>
<p>p. 222(E6.7) The text file of data, <code>stroop.txt</code>, can be downloaded from <a href="https://scipython.com/eg/aaj">https://scipython.com/eg/aaj</a>.</p>
<hr>
<p>p. 232 (P6.3.2) <code>np.hist</code> should be <code>np.histogram</code></p>
<hr>
<p>p. 245 (P6.4.1) The exponent of time in the equation for $R(t)$ should be $+\frac{2}{5}$: $R(t) = CE^{\frac{1}{5}}\rho_\mathrm{air}^{-\frac{1}{5}}t^{\frac{2}{5}}$</p>
<hr>
<p>p. 247 (P.6.4.4) The constant, $R = 8.314\;\mathrm{J\,K^{-1}\,mol^{-1}}$, should have been defined for this problem.</p>
<hr>
<p>p. 262 (P6.6.3) The classification of conic sections in terms of its matrix representation should read as follows:</p>
<ul>
<li>
<p>If $\mathrm{det} \mathbf{Q} = 0$, the conic is <em>degenerate</em> in one of the following forms:</p>
<ul>
<li>
<p>if $\mathrm{det} \mathbf{Q}_{33} &lt; 0$, the equation represents two intersecting lines,</p>
</li>
<li>
<p>if $\mathrm{det} \mathbf{Q}_{33} = 0$, the equation represents two parallel lines,</p>
</li>
<li>
<p>if $\mathrm{det} \mathbf{Q}_{33} &gt; 0$, the equation represents a single point.</p>
</li>
</ul>
</li>
<li>
<p>If $\mathrm{det} \mathbf{Q} \ne 0$:</p>
<ul>
<li>
<p>if $\mathrm{det} \mathbf{Q_{33}} &lt; 0$ the conic is a <em>hyperbola</em>,</p>
</li>
<li>
<p>if $\mathrm{det} \mathbf{Q_{33}} = 0$ the conic is a <em>parabola</em>,</p>
</li>
<li>
<p>if $\mathrm{det} \mathbf{Q_{33}} &gt; 0$, the conic is an <em>ellipse</em>:</p>
<ul>
<li>if $A=C$ and $B=0$, the ellipse is a <em>circle</em>.</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>[Thanks to Stuart Anderson for spotting this.]</p>
<hr>
<p>p. 275 The first two lines of code at the bottom of this page:</p>
<div class="codehilite"><pre><span></span>In [x]: spec = 2/n * np.abs(F[:n/2])
In [x]: pylab.plot(freq[:n/2], spec, 'k')
</pre></div>


<p>should use integer division in the array slice:</p>
<div class="codehilite"><pre><span></span>In [x]: spec = 2/n * np.abs(F[:n//2])
In [x]: pylab.plot(freq[:n//2], spec, 'k')
</pre></div>


<hr>
<p>p. 279 (P6.8.3) The line of code:</p>
<div class="codehilite"><pre><span></span>sample_rate, wav = wavfile.read(\emph{&lt;filename&gt;})
</pre></div>


<p>should read simply</p>
<div class="codehilite"><pre><span></span>sample_rate, wav = wavfile.read(&lt;filename&gt;)
</pre></div>


<p>where <code>&lt;filename&gt;</code> is the name of the <code>.wav</code> file to read in.</p>
<hr>
<p>p. 281 (§7.1.1) The code line:</p>
<p><code>line_quad, = ax.plot(x, x**2 / 2)</code></p>
<p>should read:</p>
<p><code>line_quad, = ax.plot(x, 1 + x**2 / 2)</code></p>
<hr>
<p>p. 293 (Paragraph under "Error bars" subheading): The <code>pyplot</code> function referred to is called <code>errorbar</code>, not <code>errorbars</code>.</p>
<p>p. 293 The three NumPy arrays, <code>x</code>, <code>y</code> and <code>yerr</code> should be created by calling <code>np.array</code> rather than simply <code>array</code> if NumPy has been imported as <code>np</code>, as recommended.</p>
<hr>
<p>p. 297 (E7.8) The data should be loaded into an array with <code>dtype='f8'</code> (ie double precision floating point) to avoid a deprecation warning (earlier NumPy versions) or error (later NumPy versions) upon division by 1000 in the conversion from GWh to TWh. That is, </p>
<div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">'germany-energy-sources.txt'</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">'i4'</span><span class="p">)</span>
</pre></div>


<p>should be </p>
<div class="codehilite"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="s1">'germany-energy-sources.txt'</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">'f8'</span><span class="p">)</span>
</pre></div>


<p>[Thanks to Joseph Karpinski for pointing this out].</p>
<p>Some other recent changes to Matplotlib mean that the hatching looks better if the specifiers</p>
<div class="codehilite"><pre><span></span><span class="n">hatch</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'o'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'xxxx'</span><span class="p">,</span> <span class="s1">'/'</span><span class="p">]</span>
</pre></div>


<p>are replaced by</p>
<div class="codehilite"><pre><span></span><span class="n">hatch</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'oo'</span><span class="p">,</span> <span class="s1">''</span><span class="p">,</span> <span class="s1">'xxxx'</span><span class="p">,</span> <span class="s1">'//'</span><span class="p">]</span>
</pre></div>


<p>and the bar <code>edgecolor</code> is set explicitly in the following line:</p>
<div class="codehilite"><pre><span></span><span class="n">bars</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">years</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottom</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">data</span><span class="p">[:,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">'w'</span><span class="p">,</span>
                <span class="n">hatch</span><span class="o">=</span><span class="n">hatch</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">align</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
</pre></div>


<hr>
<p>p. 302 (Listing 7.10) The diffusion equation is not implemented exactly as given in Example E7.10 (the factor of $1/4\pi$ should be $1/\sqrt{4\pi}$). That is, the code line</p>
<div class="codehilite"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta0</span> <span class="o">+</span> <span class="n">H</span><span class="o">/</span><span class="n">cp</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">t</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="n">D</span><span class="o">/</span><span class="n">t</span><span class="p">)</span>
</pre></div>


<p>should be</p>
<div class="codehilite"><pre><span></span><span class="n">theta</span> <span class="o">=</span> <span class="n">theta0</span> <span class="o">+</span> <span class="n">H</span><span class="o">/</span><span class="n">cp</span><span class="o">/</span><span class="n">A</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">D</span><span class="o">*</span><span class="n">t</span> <span class="o">*</span> <span class="mi">4</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">/</span><span class="n">D</span><span class="o">/</span><span class="n">t</span><span class="p">)</span>
</pre></div>


<p>This does not alter the output qualitatively, but has been corrected in the <a href="/resources/examples/the-one-dimensional-diffusion-equation/">online example</a>. [Thanks to Naresh Gurbuxani for spotting this error].</p>
<hr>
<p>p. 305 The URL in footnote 9 should be <a href="https://matplotlib.org/api/text_api.html">https://matplotlib.org/api/text_api.html</a>.</p>
<hr>
<p>p. 310 (Listing 7.15) The <code>axisbg</code> argument to <code>Figure.add_subplot</code> was deprecated in Matplotlib version 2.0 and replaced with <code>facecolor</code>. The line</p>
<div class="codehilite"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
</pre></div>


<p>should therefore be replaced with</p>
<div class="codehilite"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">)</span>
</pre></div>


<p>if using more recent versions of the Matplotlib library.</p>
<hr>
<p>p. 312 (E7.16) The URL for the journal article by Heinz <em>et al.</em> no longer works, but it can be found at <a href="https://doi.org/10.1080/10691898.2003.11910711">https://doi.org/10.1080/10691898.2003.11910711</a>. The necessary data file has also disappeared from the publisher's website, but can be downloaded here as <a href="/static/media/problems/P7.2/body.dat.txt"><code>body.dat.txt</code></a>.</p>
<p>[Thanks to Joseph Karpinski for noticing this].</p>
<hr>
<p>p. 314 (Listing 7.17) The <code>axisbg</code> argument to <code>Figure.add_subplot</code> was deprecated in Matplotlib version 2.0 and replaced with <code>facecolor</code>. The line</p>
<div class="codehilite"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">axisbg</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'equal'</span><span class="p">)</span>
</pre></div>


<p>should therefore be replaced with</p>
<div class="codehilite"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">'equal'</span><span class="p">)</span>
</pre></div>


<p>if using more recent versions of the Matplotlib library.</p>
<hr>
<p>p. 316 (P7.1.5) Some readers may find it helpful to have the values of the following physical constants provided in this question:</p>
<div class="codehilite"><pre><span></span><span class="c1"># Physical constants in SI units: Planck's constant (J.s),</span>
<span class="c1"># the speed of light (m.s-1), Boltzmann's constant (J.K-1)</span>
<span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">kB</span> <span class="o">=</span> <span class="mf">6.62606957e-34</span><span class="p">,</span> <span class="mi">299792458</span><span class="p">,</span> <span class="mf">1.3806488e-23</span>
</pre></div>


<hr>
<p>p. 317 The URL in footnote 14 no longer works. A suitable alternative is <a href="https://matplotlib.org/tutorials/colors/colormaps.html">https://matplotlib.org/tutorials/colors/colormaps.html</a>.</p>
<hr>
<p>p. 318 (Listing 7.18) Following <a href="https://github.com/dfm/corner.py/issues/65">a change to the Matplotlib API in v1.5.1</a>, the levels provided to <code>Axes.contour</code> must be in increasing order. To make the code in Example E7.18 work under versions v1.5.1+, the following line:</p>
<div class="codehilite"><pre><span></span>levels = list(-levels) + list(levels)
</pre></div>


<p>should be changed to:</p>
<div class="codehilite"><pre><span></span>levels = sorted(list(-levels) + list(levels))
</pre></div>


<hr>
<p>p. 320 (and Listing 7.20) In recent versions of Matplotlib, <code>interpolation='nearest'</code> is the default and <code>interpolation='bilinear'</code> now has to be explicitly set in the call to <code>plt.imshow</code> if required. The <a href="https://scipython.com/book/chapter-7-matplotlib/examples/visualizing-a-matrix-with-imshow/">online example</a> has been updated to accommodate this change.</p>
<p>p. 322 (Listing 7.21) In recent versions of NumPy, indexing with non-integers is now an error. Replace the line:</p>
<div class="codehilite"><pre><span></span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span> <span class="o">=</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">10</span><span class="p">,</span> <span class="n">y</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">12</span>
</pre></div>


<p>with:</p>
<div class="codehilite"><pre><span></span><span class="n">ix</span><span class="p">,</span> <span class="n">iy</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">width</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">width</span> <span class="o">/</span> <span class="mi">10</span><span class="p">),</span> <span class="nb">int</span><span class="p">(</span><span class="n">y</span> <span class="o">*</span> <span class="n">height</span> <span class="o">/</span> <span class="mi">12</span><span class="p">)</span>
</pre></div>


<hr>
<p>p. 325 (Listing 7.23) The array <code>u</code> should be initialized to <code>u0</code>, not left empty, since we want to keep the boundary at $T_\mathrm{cool}$. The code line:</p>
<div class="codehilite"><pre><span></span>u = np.empty((nx, ny))
</pre></div>


<p>should be:</p>
<div class="codehilite"><pre><span></span>u = u0.copy()
</pre></div>


<p>Also, the code line:</p>
<div class="codehilite"><pre><span></span>dt = dx2 * dx2 / (2 * D * (dx2 + dy2))
</pre></div>


<p>should be</p>
<div class="codehilite"><pre><span></span>dt = dx2 * dy2 / (2 * D * (dx2 + dy2))
</pre></div>


<p>(though it doesn't make any difference for the identical values of <code>dx</code> and <code>dy</code> chosen in this example).</p>
<hr>
<p>p.346 (Example E8.7) <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.special.ellipe.html"><code>scipy.special.ellipe</code></a> actually evaluates
$$
E(m) = \int_0^{\pi/2} \sqrt{1-m\sin^2\theta}\,\mathrm{d}\theta,
$$
as given correctly on the previous page. Therefore, for the orbital perimeter we need</p>
<div class="codehilite"><pre><span></span><span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="n">pe</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">a</span> <span class="o">*</span> <span class="n">ellipe</span><span class="p">(</span><span class="n">e</span><span class="o">*</span><span class="n">e</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="n">x</span><span class="p">]:</span> <span class="k">print</span><span class="p">(</span><span class="n">pe</span><span class="p">)</span>
<span class="mf">939887967.974</span>
</pre></div>


<p>and the difference from the circular orbit,</p>
<div class="codehilite"><pre><span></span><span class="p">(</span><span class="n">pc</span> <span class="o">-</span> <span class="n">pe</span><span class="p">)</span> <span class="o">/</span> <span class="n">pe</span> <span class="o">*</span> <span class="mi">100</span>
<span class="mf">0.0067215663638305143</span>
</pre></div>


<p>is only 0.0067% instead of 0.42%.</p>
<hr>
<p>p.347 (Example E8.9) The expression for the normalized Gaussian profile is missing a square in the exponent. It should be:</p>
<p>$$G(x;\sigma) = \frac{1}{\sigma\sqrt{2\pi}}\exp\left(-\frac{x^2}{2\sigma^2}\right)$$</p>
<p>The accompanying code is correct. [Thanks to Chen Ying for spotting this].</p>
<hr>
<p>p. 355 (P8.1.5) The Theis equation should read</p>
<p>$$s(r,t) = H_0 - H(r,t) = \frac{Q}{4\pi T}W(u)$$</p>
<p>($4\pi$ in the denominator, not $2\pi$).</p>
<hr>
<p>p. 359 The URL in footnote 7 should be <a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html">https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.quad.html</a>.</p>
<hr>
<p>p. 370 (Q8.2.2.e.) Compare this integral with the value of $2\pi I_0(z)$, not $I_0(z)/2\pi$.</p>
<hr>
<p>p.371 (P8.2.4: The Brusselator) The second of the scaled differential equations should read
$$
\frac{\mathrm{d}y}{\mathrm{d}t} = bx - x^2y
$$
(note the minus sign).</p>
<hr>
<p>p. 384 (Definitions of the Jacobian and Hessian functions) The definitions for functions <code>dx</code> and <code>ddx</code> do not have the correct syntax; they should be</p>
<div class="codehilite"><pre><span></span>def df(X):
</pre></div>


<p>and</p>
<div class="codehilite"><pre><span></span>def ddf(X):
</pre></div>


<p>respectively. [Thanks to Alex Hogg for spotting this].</p>
<hr>
<p>p. 391 (Demonstration of the <code>leastsq</code> function in Section 8.4.2) The variable <code>pfit</code> is never assigned. It should hold the list of best-fit parameters, returned as <code>plsq[0]</code> and output earlier on the page. Use:</p>
<div class="codehilite"><pre><span></span>pfit = plsq[0]
pylab.plot(t, f(t, *pfit), c=’k’, label=’Fit’)
</pre></div>


<p>[Thanks to Javier Elexpuru for spotting this].</p>
<hr>
<p>p. 394 (Example E8.22) The function <code>jac</code> should simply return the derivatives,</p>
<div class="codehilite"><pre><span></span>return -da, -de
</pre></div>


<p>(i.e. remove the following line, which is never executed, <code>return np.array((-da, -de)).T</code>.)</p>
<hr>
<p>p. 396 (§8.4.3) The bracketing interval $[a,b]$ should be such that $\mathrm{sgn}[f(a)] = -\mathrm{sgn}[f(b)]$. That is, $f(a)$ and $f(b)$ should bracket the root and have opposite signs. It is not necessary, of course, that $f(a) = -f(b)$.</p>
<hr>
<p>p. 397 (Caption to Figure 8.23): The function plotted is $f(x) = \frac{1}{5} + x\cos(3/x)$ (NB not $\sin$). [Thanks to Alex Hogg for pointing this out].</p>
<hr>
<p>p. 400 (Q8.4.3): The cosine in the formula for $z$ in this question should be squared:</p>
<p>$$
z = x\tan\theta_0 - \frac{g}{2v_0^2\cos^2\theta_0}x^2.
$$</p>
<hr>
<p>p. 433 (Q6.1.5e): The description of this slicing operation should be: "in the third block, for each row take (backwards) the items in all but the first column".</p>
<hr>
<h3 id="minor-typos">Minor typos</h3>
<p>p. 64 (P2.5.5): the tomorrow's date $\rightarrow$ tomorrow's date</p>
<p>p. 65 (P2.5.10): Consider region $\rightarrow$ Consider the region</p>
<p>p. 66 (§2.6): to acheive $\rightarrow$ to achieve</p>
<p>p. 78 (E2.29): there is a stray close parenthesis, ")", after $f(2)=4$.</p>
<p>p. 103 (§4.1.2) an syntactically $\rightarrow$ a syntactically</p>
<p>p. 112 (§4.2.2) keys to to be copied $\rightarrow$ keys to be copied</p>
<p>p. 122 (§4.3.1) L9: acheived $\rightarrow$ achieved</p>
<p>p. 125 (E4.10) is that if these functions $\rightarrow$ is that these functions</p>
<p>p. 127 an loop $\rightarrow$ a loop</p>
<p>p. 130 (Footnote) S. Wofram $\rightarrow$ S. Wolfram</p>
<p>p. 136 (P4.4.2) The lower case $r$ in the haversine formula should be $R$.</p>
<p>p. 137 (P4.4.2) considered as a a sphere $\rightarrow$ considered as a sphere</p>
<p>p. 150 (Listing 4.6) A abstract base class $\rightarrow$ An abstract base class</p>
<p>p. 151 (E4.16) described in class diagram $\rightarrow$ described in the class diagram</p>
<p>p. 155 (Listing 4.7, comment) Update or center of mass sum $\rightarrow$ Update our center of mass sum</p>
<p>p. 186 (Penultimate line) "often often" $\rightarrow$ "often"</p>
<p>p. 189 (Table 6.2) "floatng" $\rightarrow$  "floating"</p>
<p>p. 190 (Final line) "respecively" $\rightarrow$  "respectively"</p>
<p>p. 194 "which, tries to return" $\rightarrow$  "which tries to return"</p>
<p>p. 194 (Code comment) "create and independent" $\rightarrow$  "create an independent"</p>
<p>p. 208: "takes a, <em>sorted</em> array, <code>a</code> and" $\rightarrow$ "takes a <em>sorted</em> array, <code>a</code>, and"</p>
<p>p. 212 "respecively" $\rightarrow$ "respectively"</p>
<p>p. 217 "picked off an assigned" $\rightarrow$ "picked off and assigned"</p>
<p>p. 233: "define a the object" $\rightarrow$ "define the object"</p>
<p>p. 239: in Figure 6.7 the caption should read $n = 0,1,2,3,4$ instead of $x = 0,1,2,3,4$</p>
<p>p. 255 (P6.5.3): "<strong>MM* </strong> and <strong>MM* </strong>" $\rightarrow$ "<strong>MM* </strong> and <strong>M*M</strong>"</p>
<p>p. 269: "Poison probability distribution" $\rightarrow$ "Poisson probability distribution"</p>
<p>p. 269: "an one-dimensional sequence" $\rightarrow$ "a one-dimensional sequence"</p>
<p>p. 272 (P6.7.3) L5: "process known as chemotaxis" $\rightarrow$ "a process known as chemotaxis"</p>
<p>p. 278 (Figure 6.16): "applied its" $\rightarrow$ "applied to its"</p>
<p>p. 286: "you may wish to pass to is <code>legend</code> " $\rightarrow$ "you may wish to pass to <code>legend()</code>
p. 296 (Table 7.9): The explanation of the argument <code>height</code> appears twice in this table.</p>
<p>p. 338 (Figure 8.1 caption): "gravitationa" $\rightarrow$ "gravitational"</p>
<p>p. 339 (Last bullet point): <code>jn_zeros(n, nt)</code> appears twice.</p>
<p>p. 341 (Example E8.4) There should be no period after "1953".</p>
<p>p. 345 (Footnote) "instead $m$" $\rightarrow$ "instead of $m$"</p>
<p>p. 366 (top of the page): $\frac{\mathrm{d}x_2}{\mathrm{d}t_2}$ should be $\frac{\mathrm{d}x_2}{\mathrm{d}t}$</p>
<p>p. 368 "Drag consant" $\rightarrow$ "Drag constant"</p>
<p>p. 390 (§8.4.2) The function to be fit is $f(t) = Ae^{-t/\tau}\cos 2\pi\nu t$, so $\tau$ is positive.</p>
<p>p. 447 (Index): <code>plt.errorbars</code> $\rightarrow$ <code>plt.errorbar</code></p>



</div>

</div>
</div>

<footer>
<div class="container">
</div>
</footer>








<script>

var _gaq = _gaq || [['_trackPageview']];
_gaq.unshift(['_setAccount', 'UA-91424547-3']);
(function(d, t) {
    var g = d.createElement(t),
        s = d.getElementsByTagName(t)[0];
    g.async = true;
    g.src = '//www.google-analytics.com/ga.js';
    s.parentNode.insertBefore(g, s);
})(document, 'script');

</script>


</body>
</html>
